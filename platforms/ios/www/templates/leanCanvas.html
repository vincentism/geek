<style>
a {
  color: #00B7FF;
  position: relative;
}
.lean-wrapper, .projectTitle{
  width: 80%;
  margin: 0 auto;
  text-align: center;
  margin-top: 1em;
}
.lean-wrapper{
    overflow-x: scroll;
}
.lean-item{
    padding: 1em 10%;
    box-sizing: border-box;
}

@media screen and (max-width: 414px){
    .lean-item{
        padding: 1em 10px;
        box-sizing: border-box;
    }
}
.product-logo{
    width: 40px;
}
.lean-title{
    display: inline-block;
    vertical-align: top;
    height: 40px;
    line-height: 40px;
    margin: 0 0 0 1em;
}
.lean-slogan{
    display: inline-block;
    vertical-align: top;
    height: 40px;
    line-height: 40px;
    margin: 0 0 0 2em;
}
.lean-tag, .lean-comp{
    display: inline-block;
    float: right;
}
.lean-des{
    display: inline-block;
    vertical-align: top;
    height: 40px;
    line-height: 40px;
    margin: 1em 0;
}
.lean-pic{
    display: inline-block;
    margin: 0 0 1em 0;
}
.pic-des{
    width: 200px;
    margin: 1em 1em 1em 0;
}
@media screen and (max-width: 414px){
    .pic-des{
        width: 100%;
        display: block;
        margin: 1em auto;
    }
    .lean-tag,.lean-comp{
        display: none;
    }
}
@media screen and (max-width:800px) {
    .lean-wrapper{
        width: 100%;
    }
}

.clearfix:after {
  content: ".";
  display: block;
  height: 0;
  clear: both;
  visibility: hidden;
}
.clearfix {
    display:inline-block;
}
* html .clearfix {
    height:1%;
}
.clearfix {
    display:block;
}
.left {
    float: left;
}
.right {
    float: right;
}
.block {
    display: block;
}
.show-grid {
  cursor: pointer;
  position: relative;
  overflow: hidden;
  min-height: 214px;
}
table.table{
    width: 100%;
    min-width: 960px;
}
table.table td {
  position: relative;
  border: 1px solid #000;
}
table.table td:hover {
  background-color: #ecf0fa;
}

.show-default {
  font-size: 400%;
  font-weight: bold;
  color: #51a351;
  min-height: 150px;
  line-height: 150px;
  text-align: center;
}

.show-title-wrap {
  width: 100%;
}

.show-title-inner {
    padding: 5px;
}

.show-title {
    font-weight: bold;
    font-size: 16px;
    line-height: 24px;
}

.show-title-info {
    font-size: 12px;
    color: #CCC;
    padding-left: 5px;
    box-sizing: border-box;
}

.item-list {
  width: 100%;
}

.show-item {
  padding: 5px;
}

.input-wrap {
  padding: 5px;
}

.input-wrap em {
  padding-left: 5px;
  padding-right: 5px;
  font-size: 12px;
}

input.input-item {
  width: 90%;
  padding: 0;
}
input.submit {
  padding: 0 2px;
  font-size: 12px;
}
input.cancel {
  color: #CCC;
  border: none;
  background: none;
  padding: 0 2px;
  font-size: 12px;
}

.show-item .show-item-name {
  cursor: move;
  min-height: 16px;
  font-size: 12px;
}
.show-item .show-item-delete {
  min-height: 16px;
  font-size: 12px;
}
.help-wrap {
    display: none;
}
table.table td:hover .help-wrap {
    display: block;
}
.help {
    background: url(../img/help.png) no-repeat 50% 50%;
    width: 24px;
    height: 24px;
    display: block;
}
.show-feed {
    position: absolute;
    bottom: 10px;
    left: 10px;
    font-size: 12px;
    display: none;
}
table.table td:hover .show-feed {
    display: block;
}
.delete {
    background: url(../img/delete.gif) no-repeat 50% 50%;
    width: 10px;
    height: 14px;
    display: none;
}
.show-item:hover .delete {
    display: block;
}
.show-item:hover .show-item-name {
    background-color: #FFF;
}
</style>
<ion-view view-title="创建新项目">
  <ion-content>
    <div class="list">
        <div class="item lean-item">
            <img class="product-logo" src="../img/ionic.png">
            <span class="lean-title">易道云</span>
            <span class="lean-slogan">slogan</span>
            <span class="lean-tag">产品标签</span>
        </div>
        <div class="item lean-item">
            <span class="lean-des">产品描述</span>
            <span class=""></span>
        </div>
        <div class="item lean-item">
            <span class="lean-pic">图片或视频介绍</span>
            <div class="clear"></div>
            <img class="pic-des" src="../img/banner.png">
            <img class="pic-des" src="../img/banner.png">
            <img class="pic-des" src="../img/banner.png">
            <img class="pic-des" src="../img/banner.png">
            <span class="lean-comp">竞争对手</span>
        </div>
    </div>
    <div class="lean-wrapper padding">
      <table class="table table-bordered">
          <tbody>
              <tr>
                  <td rowspan="2" style="width:20%;">
                      <div class="show-grid">
                          <div class="show-title-wrap">
                              <div class="show-title-inner clearfix">
                                  <div class="left">
                                      <div class="show-title">问题痛点</div>
                                  </div>
                                  <div class="right help-wrap">
                                      <a href="javascript:{}" class="help"></a>
                                  </div>
                              </div>
                              <div class="show-title-info">问题痛点1</div>
                          </div>
                          <div class="show-default">2</div>
                          <ul class="item-list unstyled"></ul>
                      </div>
                      <a class="show-feed" href="javascript:{}">发表评论</a>
                  </td>
                  <td class="show-grid" style="width:20%;">
                      <div class="show-title-wrap">
                          <div class="show-title-inner clearfix">
                              <div class="left">
                                  <div class="show-title">解决方案</div>
                              </div>
                              <div class="right help-wrap">
                                  <a href="javascript:{}" class="help"></a>
                              </div>
                          </div>
                          <div class="show-title-info">大纲对每个问题的可能的解决方案</div>
                      </div>
                      <div class="show-default">4</div>
                      <ul class="item-list unstyled"></ul>
                      <a class="show-feed" href="javascript:{}">发表评论</a>
                  </td>
                  <td rowspan="2" colspan="2" style="width:20%;">
                      <div class="show-grid">
                          <div class="show-title-wrap">
                              <div class="show-title-inner clearfix">
                                  <div class="left">
                                      <div class="show-title">独特卖点</div>
                                  </div>
                                  <div class="right help-wrap">
                                      <a href="javascript:{}" class="help"></a>
                                  </div>
                              </div>
                              <div class="show-title-info">单一的，明确的，令人信服的信息</div>
                          </div>
                          <div class="show-default">3</div>
                          <ul class="item-list unstyled"></ul>
                      </div>
                      <a class="show-feed" href="javascript:{}">发表评论</a>
                  </td>
                  <td class="show-grid" style="width:20%;">
                      <div class="show-title-wrap">
                          <div class="show-title-inner clearfix">
                              <div class="left">
                                  <div class="show-title">门槛</div>
                              </div>
                              <div class="right help-wrap">
                                  <a href="javascript:{}" class="help"></a>
                              </div>
                          </div>
                          <div class="show-title-info">不能轻易复制或买的东西</div>
                      </div>
                      <div class="show-default">9</div>
                      <ul class="item-list unstyled"></ul>
                      <a class="show-feed" href="javascript:{}">发表评论</a>
                  </td>
                  <td rowspan="2" style="width:20%;">
                      <div class="show-grid">
                          <div class="show-title-wrap">
                              <div class="show-title-inner clearfix">
                                  <div class="left">
                                      <div class="show-title">客户细分</div>
                                  </div>
                                  <div class="right help-wrap">
                                      <a href="javascript:{}" class="help"></a>
                                  </div>
                              </div>
                              <div class="show-title-info">列出你的目标客户和用户</div>
                          </div>
                          <div class="show-default">1</div>
                          <ul class="item-list unstyled"></ul>
                      </div>
                      <a class="show-feed" href="javascript:{}">发表评论</a>
                  </td>
              </tr>
              <tr>
                  <td class="show-grid" style="width:20%;">
                      <div class="show-title-wrap">
                          <div class="show-title-inner clearfix">
                              <div class="left">
                                  <div class="show-title">关键指标</div>
                              </div>
                              <div class="right help-wrap">
                                  <a href="javascript:{}" class="help"></a>
                              </div>
                          </div>
                          <div class="show-title-info">列出关键数字</div>
                      </div>
                      <div class="show-default">8</div>
                      <ul class="item-list unstyled"></ul>
                      <a class="show-feed" href="javascript:{}">发表评论</a>
                  </td>
                  <td class="show-grid" style="width:20%;">
                      <div class="show-title-wrap">
                          <div class="show-title-inner clearfix">
                              <div class="left">
                                  <div class="show-title">渠道</div>
                              </div>
                              <div class="right help-wrap">
                                  <a href="javascript:{}" class="help"></a>
                              </div>
                          </div>
                          <div class="show-title-info">列出你的路径给客户</div>
                      </div>
                      <div class="show-default">5</div>
                      <ul class="item-list unstyled"></ul>
                      <a class="show-feed" href="javascript:{}">发表评论</a>
                  </td>
              </tr>
              <tr>
                  <td colspan="3" class="show-grid">
                      <div class="show-title-wrap">
                          <div class="show-title-inner clearfix">
                              <div class="left">
                                  <div class="show-title">成本结构</div>
                              </div>
                              <div class="right help-wrap">
                                  <a href="javascript:{}" class="help"></a>
                              </div>
                          </div>
                          <div class="show-title-info">列出您的固定和可变成本</div>
                      </div>
                      <div class="show-default">7</div>
                      <ul class="item-list unstyled"></ul>
                      <a class="show-feed" href="javascript:{}">发表评论</a>
                  </td>
                  <td colspan="3" class="show-grid">
                      <div class="show-title-wrap">
                          <div class="show-title-inner clearfix">
                              <div class="left">
                                  <div class="show-title">收入来源</div>
                              </div>
                              <div class="right help-wrap">
                                  <a href="javascript:{}" class="help"></a>
                              </div>
                          </div>
                          <div class="show-title-info">列出你的收入来源</div>
                      </div>
                      <div class="show-default">6</div>
                      <ul class="item-list unstyled"></ul>
                      <a class="show-feed" href="javascript:{}">发表评论</a>
                  </td>
              </tr>
          </tbody>
      </table>
    </div>
  </ion-content>
  <script src="tools/jquery.tmpl.min.js"></script>
  <script src="tools/bootstrap.min.js"></script>
  <script>

  var Index = (function() {

    /**
     * 循环的判断每个区块是否展示默认提示信息
     */
    var _checkShowDefault = function() {
      jQuery('.show-grid').each(function() {
        var showDefault = jQuery(this).find('.show-default');
        var showTitleInfo = jQuery(this).find('.show-title-info');
        if(jQuery(this).find('li').length > 0) {
          showDefault.hide();
          showTitleInfo.hide();
        } else {
          showDefault.show();
          showTitleInfo.show();
        }
      });
    };

    /**
     * 清楚全部的输入框
     */
    var _clearAllInput = function() {
      jQuery('.item-wrap').remove();
    };

    /**
     * 输入框的模版 用于构造输入框片段
     */
    var inputTmpl = ['<li class="item-wrap">',
      '<div class="input-wrap">',
      '<div><input type="text" class="input-item" name="input-item" value="${name}" /></div>',
      '<div><input type="button" class="submit" value="保存" /><em>或</em><input type="button" class="cancel" value="取消" /></div>',
      '</div>',
      '</li>'].join('');

    /**
     * 增加输入框片段到列表(itemList)
     */
    var _appendInputItem = function(itemList) {
      _clearAllInput();
      jQuery(itemList).find('.item-wrap').remove();
      jQuery.tmpl(inputTmpl, {name: ''}).appendTo(itemList);
      _initInputListener();
      _checkShowDefault();
    };

    /**
     * 绑定输入框的事件
     */
    var _initInputListener = function() {
      jQuery('.item-wrap').each(function() {
        var itemWrap = this;
        var itemList = jQuery(itemWrap).parent();
        jQuery(this).find('.input-item').focus().keypress(function(e) {
          var key = e.which;
          if(key === 13) {
            _appendShowItem(itemList);
          }
        });
        jQuery(this).find('.submit').click(function(event) {
          event.stopPropagation();
          _appendShowItem(itemList);
        });
        jQuery(this).find('.cancel').click(function(event) {
          event.stopPropagation();
          _cancelItemWrap(itemWrap);
        });
      });
    };


    /**
     * 点击输入框的取消按钮
     */
    var _cancelItemWrap = function(itemWrap) {
      jQuery(itemWrap).remove();
      _checkShowDefault();
    };

    /**
     * 通过输入框添加的内容展示模版
     */
    var _showTmpl = ['<li class="show-item"><div class="row-fluid">' +
      '<div class="span10 text-left show-item-name">${name}</div>',
      '<div class="span2 show-item-delete"><a class="delete" href="javascript:{}"></a></div>',
    '</div></li>'].join('');

    /**
     * 增加展示片段到列表(itemList)
     */
    var _appendShowItem = function(itemList) {
      var name = jQuery(itemList).find('.input-item').first().val();
      if(name && name !== '') {
        var itemWrap = jQuery(itemList).find('.item-wrap');
        console.log(itemWrap);
        if(itemWrap.size() > 0) {
          itemWrap.replaceWith(jQuery(jQuery.tmpl(_showTmpl, {name: name})));
        } else {
          jQuery.tmpl(_showTmpl, {name: name}).appendTo(itemList);
        }
        _appendInputItem(itemList);
      } else {
        jQuery(itemList).remove();
      }
      _checkShowDefault();
      _initShowItem();
    };

    /**
     * 为垃圾桶图标绑定删除事件
     */
    var _initDelItem = function() {
      jQuery('.delete').unbind('click');
      jQuery('.delete').click(function(event) {
        event.stopPropagation();
        var showItem = jQuery(this).parents('.show-item');
        showItem.remove();
        _clearAllInput();
        _checkShowDefault();
        _initShowItem();
      });
    };

    /**
     * 为已有的内容绑定点击事件 点击后转换为编辑状态
     */
    var _initEditItem = function() {
      jQuery('.show-item-name').unbind('click');
      jQuery('.show-item-name').click(function(event) {
        event.stopPropagation();
        _clearAllInput();
        var name = jQuery(this).html();
        jQuery(this).parents('.show-item').replaceWith(jQuery(jQuery.tmpl(inputTmpl, {name: name})));
        _initInputListener();
        _checkShowDefault();
      });
    };

    /**
     * 为列表中展示的内容绑定退拽事件 用户可以通过拖拽调整内容的顺序
     */
    var _initShowItem = function() {
      jQuery('.item-list').sortable();
      jQuery('.item-list').disableSelection();
      _initEditItem();
      _initDelItem();
    };

    /**
     * 绑定帮助按钮点击事件
     */
    var _initHelp = function() {
      jQuery('.help').click(function(event) {
        event.stopPropagation();
        jQuery('<div></div>')
          .html('正在建设中...')
          .dialog({
            autoOpen: false,
            title: '帮助'
          }).dialog('open');
      })
    };

    /**
     * 绑定评论点击事件
     */
    var _initFeed = function() {
      jQuery('.show-feed').click(function(event) {
        event.stopPropagation();
        jQuery('<div></div>').html(['<div>',
            '<textarea style="width:240px;height:90px;line-height:16px;"></textarea>',
          '</div>',
          '<div><input type="button" value="提交" /></div>'].join('')).dialog({
            autoOpen: false,
            title: '发表评论'
          }).dialog('open');
      })
    };

    /**
     * 初始化页面
     */
    var init = function() {
      jQuery('.show-grid').click(function(event) {
        event.stopPropagation();
        var itemList = jQuery(this).find('.item-list').first();
        _appendInputItem(itemList);
      });
      _initShowItem();
      _initHelp();
      _initFeed();
    };

    return {
      init: init
    };
  }).call(this);
  Index.init();

  </script>
</ion-view>
